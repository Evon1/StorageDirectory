<% declare_content_for %>
<%= display_message flash %>

<h2><%= defined?(heading) ? heading : model_form_heading %></h2>

<%= render_model_helptext(controller_name) %>

<div class="clear">
	<% form_for model, :html => (defined?(html) ? html : {}) do |f| %>
		<%= f.error_messages %>
		
		<%= render :partial => "#{controller_name}/form", :locals => { :f => f } %>
		
		<div class="uncollapse stack">
			<div class="buttons left">
				<% submit_text = defined?(heading) ? "Update #{heading}" : (model.new_record? ? "Add #{model_name(model).titleize}" : 'Save Changes') %>
				<%= submit_tag submit_text %>
			</div>
			
			<% unless defined?(hide_delete_link) && hide_delete_link %>
				<div class="buttons right">
					<%= link_to 'Delete', ajax_action_path(:destroy, :model => model_name(model), :id => model.id), :rel => "model_form", :class => 'ajax_action before_confirm iconOnly16 delete_link right note', :title => "Delete #{model.name_or_title}" %>
					<%= link_to 'Cancel', (session[:return_to] || :back), :class => 'iconOnly16 cancel_link right', :title => "Cancel editing #{model.name_or_title}" %>
				</div>
			<% end %>
			
		</div>
		
	<% end %>
</div>